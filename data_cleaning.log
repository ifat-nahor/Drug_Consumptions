2026-01-25 18:00:41,898 - INFO -  Loading data from: c:\Users\ifatn\OneDrive\phyton_bit\final_proj\final_proj\src\..\data\raw\Drug_Consumption.csv
2026-01-25 18:00:42,428 - INFO - 
================================================================================
[STARTING COMPLETE DATA QUALITY ASSESSMENT & CLEANING PIPELINE]
================================================================================
2026-01-25 18:00:42,429 - INFO - 
================================================================================
[STEP 1: DATASET OVERVIEW]
================================================================================
2026-01-25 18:00:42,489 - INFO - Records: 1,884 | Features: 32
2026-01-25 18:00:42,489 - INFO - Memory Usage: 2.41 MB
2026-01-25 18:00:42,489 - INFO - 
================================================================================
[STEP 2: MISSING VALUES]
================================================================================
2026-01-25 18:00:42,506 - INFO -  No missing values detected - dataset is complete
2026-01-25 18:00:42,507 - INFO - 
================================================================================
[STEP 3: DUPLICATE DETECTION]
================================================================================
2026-01-25 18:00:42,671 - INFO - No duplicate records found
2026-01-25 18:00:42,674 - INFO - 
================================================================================
[STEP 4: NUMERIC CONVERSION]
================================================================================
2026-01-25 18:00:42,774 - INFO - Current Data Types (before conversion):
Nscore       float64
Escore       float64
Oscore       float64
AScore       float64
Cscore       float64
Impulsive    float64
SS           float64
dtype: object
--------------------
2026-01-25 18:00:42,811 - INFO -  Successfully converted 7 columns to numeric format.
2026-01-25 18:00:42,813 - INFO - 
================================================================================
[STEP 5: OUTLIER DETECTION - PERSONALITY SCORES]
================================================================================
2026-01-25 18:00:42,868 - INFO -   Feature  Outliers  Outlier_Rate_%  Lower_Bound  Upper_Bound  Min_Value  Max_Value
   Nscore         0             0.0       -4.602        4.553     -3.464      3.274
   Escore         0             0.0       -4.694        4.636     -3.274      3.274
   Oscore         0             0.0       -5.039        5.045     -3.274      2.902
   AScore         0             0.0       -4.708        4.863     -3.464      3.464
   Cscore         0             0.0       -4.365        4.297     -3.464      3.464
Impulsive         0             0.0       -4.434        4.253     -2.555      2.902
       SS         0             0.0       -4.400        4.639     -2.078      1.922
2026-01-25 18:00:42,869 - INFO - 
 Note: Personality scores are standardized (mean=0, SD=1)
2026-01-25 18:00:42,869 - INFO -    Extreme outliers may indicate data entry errors or measurement issues
2026-01-25 18:00:42,870 - INFO - 
================================================================================
[STEP 6: DRUG CONSUMPTION VALIDATION]
================================================================================
2026-01-25 18:00:42,928 - INFO - All 19 drug columns have valid encodings
2026-01-25 18:00:42,934 - INFO - 
================================================================================
[STEP 6.5: CONVERT DRUG CONSUMPTION TO NUMERIC]
================================================================================
2026-01-25 18:00:43,024 - INFO - Successfully converted 19 columns to numeric scale (0-6).
2026-01-25 18:00:43,024 - INFO - 
================================================================================
[STEP 7: DEMOGRAPHIC VARIABLES CONSISTENCY CHECK]
================================================================================
2026-01-25 18:00:43,025 - INFO - 
 AGE DISTRIBUTION:
2026-01-25 18:00:43,077 - INFO -    Unique Levels: 6
2026-01-25 18:00:43,091 - INFO -    Distribution:
Age
18-24    643
25-34    481
35-44    355
45-54    294
55-64     93
65+       18
2026-01-25 18:00:43,117 - INFO - 
 GENDER DISTRIBUTION:
2026-01-25 18:00:43,134 - INFO -    M: 943 (50.1%)
2026-01-25 18:00:43,135 - INFO -    F: 941 (49.9%)
2026-01-25 18:00:43,135 - INFO - 
 EDUCATION DISTRIBUTION:
2026-01-25 18:00:43,137 - INFO -    Unique Levels: 9
2026-01-25 18:00:43,138 - INFO -    Some college or university, no certificate or degree: 506 (26.9%)
2026-01-25 18:00:43,139 - INFO -    University degree: 480 (25.5%)
2026-01-25 18:00:43,139 - INFO -    Masters degree: 283 (15.0%)
2026-01-25 18:00:43,143 - INFO -    Professional certificate/ diploma: 269 (14.3%)
2026-01-25 18:00:43,152 - INFO -    Left school at 18 years: 100 (5.3%)
2026-01-25 18:00:43,155 - INFO -    Left school at 16 years: 99 (5.3%)
2026-01-25 18:00:43,157 - INFO -    Doctorate degree: 89 (4.7%)
2026-01-25 18:00:43,158 - INFO -    Left school at 17 years: 30 (1.6%)
2026-01-25 18:00:43,160 - INFO -    Left school before 16 years: 28 (1.5%)
2026-01-25 18:00:43,170 - INFO - 
 COUNTRY DISTRIBUTION:
2026-01-25 18:00:43,172 - INFO -    Total Countries: 7
2026-01-25 18:00:43,173 - INFO -    Top 10 Countries:
2026-01-25 18:00:43,175 - INFO -       UK: 1,043 (55.4%)
2026-01-25 18:00:43,175 - INFO -       USA: 557 (29.6%)
2026-01-25 18:00:43,177 - INFO -       Other: 118 (6.3%)
2026-01-25 18:00:43,177 - INFO -       Canada: 87 (4.6%)
2026-01-25 18:00:43,178 - INFO -       Australia: 54 (2.9%)
2026-01-25 18:00:43,180 - INFO -       Republic of Ireland: 20 (1.1%)
2026-01-25 18:00:43,184 - INFO -       New Zealand: 5 (0.3%)
2026-01-25 18:00:43,185 - INFO - 
================================================================================
[STEP 8: DESCRIPTIVE STATISTICS - PERSONALITY TRAITS]
================================================================================
2026-01-25 18:00:43,223 - INFO -             count   mean    std    min    25%    50%    75%    max  Skewness  Kurtosis
Nscore     1884.0 -0.000  0.998 -3.464 -0.678  0.043  0.630  3.274     0.000    -0.032
Escore     1884.0  0.000  0.998 -3.274 -0.695  0.003  0.638  3.274    -0.003    -0.030
Oscore     1884.0 -0.000  0.996 -3.274 -0.717 -0.019  0.723  2.902    -0.011    -0.058
AScore     1884.0  0.000  0.997 -3.464 -0.606 -0.017  0.761  3.464    -0.005    -0.020
Cscore     1884.0 -0.000  0.998 -3.464 -0.653 -0.007  0.585  3.464    -0.005    -0.025
Impulsive  1884.0  0.007  0.955 -2.555 -0.711 -0.217  0.530  2.902     0.072    -0.297
SS         1884.0 -0.003  0.964 -2.078 -0.526  0.080  0.765  1.922    -0.042    -0.447
2026-01-25 18:00:43,224 - INFO - 
================================================================================
[STEP 9: PRIMARY CORRELATION ANALYSIS]
================================================================================
2026-01-25 18:00:43,224 - INFO - Hypothesis: Correlation between Impulsive and SS
2026-01-25 18:00:43,229 - INFO - 
Pearson Correlation Coefficient: r = 0.6232
2026-01-25 18:00:43,234 - INFO - P-value: 3.3926e-203
2026-01-25 18:00:43,235 - INFO - N (valid pairs): 1884
2026-01-25 18:00:43,235 - INFO - Effect Size: LARGE (|r| = 0.6232)
2026-01-25 18:00:43,235 - INFO - *** HIGHLY SIGNIFICANT (p < 0.001) ***
2026-01-25 18:00:43,236 - INFO - 
================================================================================
[STEP 10: NORMALITY ASSESSMENT & DISTRIBUTION SHAPE]
================================================================================
2026-01-25 18:00:43,236 - INFO - Interpreting Normality:
2026-01-25 18:00:43,236 - INFO -   Skewness: 0 = symmetric, ±0.5 = acceptable, >±1 = highly skewed
2026-01-25 18:00:43,241 - INFO -   Kurtosis: 0 = normal, <3 = light tails, >3 = heavy tails
2026-01-25 18:00:43,242 - INFO -   Shapiro-Wilk: p > 0.05 = normally distributed

2026-01-25 18:00:43,277 - INFO - 
  Feature Skewness Kurtosis Shapiro_p Normal_Dist  N_Tested
   Nscore    0.000   -0.032    0.1667         Yes      1884
   Escore   -0.003   -0.030    0.0130          No      1884
   Oscore   -0.011   -0.058    0.0030          No      1884
   AScore   -0.005   -0.020    0.0107          No      1884
   Cscore   -0.005   -0.025    0.0183          No      1884
Impulsive    0.072   -0.297    0.0000          No      1884
       SS   -0.042   -0.447    0.0000          No      1884
2026-01-25 18:00:43,277 - INFO - 
================================================================================
[FINAL CLEANING SUMMARY]
================================================================================
2026-01-25 18:00:43,278 - INFO -  Final Records: 1,884
2026-01-25 18:00:43,278 - INFO -  Records Removed (Duplicates): 0
2026-01-25 18:00:43,279 - INFO -  Total Features: 32
2026-01-25 18:00:43,288 - INFO -  Data Completeness: 100.00%
2026-01-25 18:00:43,289 - INFO -  Dataset Status: READY FOR STATISTICAL ANALYSIS
2026-01-25 18:00:43,289 - INFO - ================================================================================
2026-01-25 18:00:43,289 - INFO - 
================================================================================
[STARTING FEATURE ENGINEERING PIPELINE]
================================================================================
2026-01-25 18:00:43,289 - INFO - 
================================================================================
[STEP 11A: AGGREGATING DRUG FAMILIES]
================================================================================
2026-01-25 18:00:43,293 - INFO -  Created Score_Stimulants from 5 columns
2026-01-25 18:00:43,299 - INFO -  Created Score_Depressants from 3 columns
2026-01-25 18:00:43,303 - INFO -  Created Score_Hallucinogens from 2 columns
2026-01-25 18:00:43,304 - INFO - 
================================================================================
[STEP 11B: GENERATING CLUSTERS (K-MEANS) FOR: Cannabis]
================================================================================
2026-01-25 18:00:48,641 - INFO -  Clusters created for 'Cannabis':
2026-01-25 18:00:48,643 - INFO - Usage_Group
Regular       648
Non-User      619
Occasional    617
2026-01-25 18:00:48,678 - INFO - 
 Saved fully processed data to: c:\Users\ifatn\OneDrive\phyton_bit\final_proj\final_proj\src\..\data\processed\Drug_Consumption_Cleaned.csv
2026-01-25 18:00:48,678 - INFO - === Starting Personality Drug Pipeline ===
2026-01-25 18:00:48,728 - INFO - Data loaded and scaled. Shape: (1884, 36)
2026-01-25 18:00:48,749 - INFO - PCA completed (3 components). Explained variance: 70.78%
2026-01-25 18:00:48,749 - INFO - Running clustering diagnostics for K selection...
2026-01-25 18:01:41,108 - INFO - Final clustering completed with K=3
2026-01-25 18:01:41,115 - INFO - Personality profiles (cluster means):
2026-01-25 18:01:41,117 - INFO - 
         Nscore  Escore  Oscore  AScore  Cscore  Impulsive    SS
Cluster                                                         
0         -0.53    0.80    0.64    0.19    0.27       0.41  0.59
1          0.83   -0.62    0.09   -0.55   -0.83       0.53  0.38
2         -0.25   -0.16   -0.63    0.30    0.48      -0.78 -0.84
2026-01-25 18:01:46,468 - INFO - Mean substance use table saved to: C:\Users\ifatn\OneDrive\phyton_bit\final_proj\final_proj\plots_pics_for_pca_cluster\mean_substance_use_by_cluster.csv
2026-01-25 18:01:46,471 - INFO - Summary of substance use by cluster (max/min means):
2026-01-25 18:01:46,472 - INFO - 
     Drug  Max_Cluster  Max_Mean  Min_Cluster  Min_Mean
  Alcohol            0      4.74            2      4.55
   Amphet            1      1.96            2      0.62
     Amyl            0      0.74            2      0.39
   Benzos            1      2.23            2      0.77
     Caff            0      5.54            2      5.44
 Cannabis            1      3.84            2      1.66
     Choc            2      5.18            1      5.03
     Coke            1      1.62            2      0.56
    Crack            1      0.50            2      0.10
  Ecstasy            0      1.81            2      0.56
   Heroin            1      0.70            2      0.10
 Ketamine            0      0.79            2      0.22
   Legalh            1      2.03            2      0.52
      LSD            0      1.51            2      0.40
     Meth            1      1.35            2      0.35
Mushrooms            0      1.64            2      0.48
 Nicotine            1      3.95            2      2.29
    Semer            0      0.01            2      0.01
      VSA            1      0.71            2      0.14
2026-01-25 18:01:46,475 - INFO - Substance use summary table saved to: C:\Users\ifatn\OneDrive\phyton_bit\final_proj\final_proj\plots_pics_for_pca_cluster\substance_use_cluster_summary.csv
2026-01-25 18:01:46,475 - INFO - ANOVA results table saved to: C:\Users\ifatn\OneDrive\phyton_bit\final_proj\final_proj\plots_pics_for_pca_cluster\anova_results.csv
2026-01-25 18:01:46,476 - INFO - Analysis complete. 17/19 drugs show significant variance.
2026-01-25 18:01:46,477 - INFO - Conclusion: Personality profiles are predictive of drug consumption.
